# Практическая работа 18. Применение условного рендеринга в Angular

### **Тема:** Условный рендеринг с помощью `@if`, `@switch` и структурных директив

### **Цель:** 
Научиться применять условный рендеринг в Angular приложениях для создания динамических интерфейсов. Освоить новые синтаксисы `@if`, `@else`, `@switch` и сравнить их с традиционными структурными директивами.

### **Теоретическая часть:**

**Условный рендеринг** - это механизм отображения различных частей интерфейса в зависимости от условий.

**Новый синтаксис (Angular 17+):**

1. **`@if` блок:**
```typescript
@if (condition) {
  <!-- Контент показывается когда condition = true -->
  <div>Отображается при true</div>
}
```

2. **`@else` блок:**
```typescript
@if (condition) {
  <div>Условие true</div>
} @else {
  <div>Условие false</div>
}
```

3. **`@else if` блок:**
```typescript
@if (score >= 90) {
  <div>Отлично!</div>
} @else if (score >= 70) {
  <div>Хорошо</div>
} @else {
  <div>Нужно улучшить</div>
}
```

4. **`@switch` блок:**
```typescript
@switch (status) {
  @case ('active') {
    <div>Активный</div>
  }
  @case ('inactive') {
    <div>Неактивный</div>
  }
  @default {
    <div>Неизвестный статус</div>
  }
}
```

**Традиционный синтаксис (структурные директивы):**
```html
<div *ngIf="condition; else elseBlock">Контент</div>
<ng-template #elseBlock>Альтернативный контент</ng-template>

<div [ngSwitch]="status">
  <div *ngSwitchCase="'active'">Активный</div>
  <div *ngSwitchDefault>Неизвестно</div>
</div>
```

**Преимущества нового синтаксиса:**
- Лучшая читаемость
- Улучшенная типобезопасность
- Более интуитивный синтаксис
- Лучшая поддержка в IDE

### **Ход работы:**

1. Создать новый Angular проект с поддержкой нового синтаксиса
2. Реализовать компоненты согласно варианту задания
3. Применить различные подходы к условному рендерингу
4. Добавить интерактивность для тестирования условий
5. Стилизовать компоненты
6. Протестировать все возможные состояния
7. Оформить README.md с описанием работы

### **Практический пример:**

**Компонент системы уведомлений:**

1. **notification.component.ts:**
```typescript
import { Component, signal } from '@angular/core';

export type NotificationType = 'success' | 'error' | 'warning' | 'info';

@Component({
  selector: 'app-notification',
  templateUrl: './notification.component.html',
  styleUrls: ['./notification.component.css']
})
export class NotificationComponent {
  // Сигналы для состояния
  showNotification = signal(false);
  notificationType = signal<NotificationType>('info');
  message = signal('');

  // Показать уведомление
  show(type: NotificationType, msg: string) {
    this.notificationType.set(type);
    this.message.set(msg);
    this.showNotification.set(true);
    
    // Автоматическое скрытие через 5 секунд
    setTimeout(() => {
      this.hide();
    }, 5000);
  }

  // Скрыть уведомление
  hide() {
    this.showNotification.set(false);
  }

  // Получить класс для иконки
  getIconClass(): string {
    switch (this.notificationType()) {
      case 'success': return '✓';
      case 'error': return '✗';
      case 'warning': return '⚠';
      case 'info': return 'ℹ';
      default: return '';
    }
  }
}
```

2. **notification.component.html:**
```html
<!-- Условное отображение всего компонента уведомления -->
@if (showNotification()) {
  <div class="notification" [class]="'notification-' + notificationType()">
    <div class="notification-content">
      <span class="notification-icon">{{ getIconClass() }}</span>
      <span class="notification-message">{{ message() }}</span>
      <button class="notification-close" (click)="hide()">×</button>
    </div>
  </div>
}

<!-- Кнопки для тестирования -->
<div class="demo-controls">
  <h3>Тестирование уведомлений:</h3>
  
  <div class="button-group">
    <button (click)="show('success', 'Операция выполнена успешно!')">
      Успех
    </button>
    <button (click)="show('error', 'Произошла ошибка!')">
      Ошибка
    </button>
    <button (click)="show('warning', 'Внимание! Проверьте данные.')">
      Предупреждение
    </button>
    <button (click)="show('info', 'Новая информация доступна.')">
      Информация
    </button>
  </div>
</div>
```

3. **notification.component.css:**
```css
.notification {
  position: fixed;
  top: 20px;
  right: 20px;
  padding: 16px;
  border-radius: 8px;
  color: white;
  min-width: 300px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.15);
  z-index: 1000;
  animation: slideIn 0.3s ease;
}

.notification-success {
  background-color: #28a745;
  border-left: 4px solid #1e7e34;
}

.notification-error {
  background-color: #dc3545;
  border-left: 4px solid #c82333;
}

.notification-warning {
  background-color: #ffc107;
  color: #212529;
  border-left: 4px solid #e0a800;
}

.notification-info {
  background-color: #17a2b8;
  border-left: 4px solid #138496;
}

.notification-content {
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.notification-icon {
  font-weight: bold;
  margin-right: 12px;
  font-size: 1.2em;
}

.notification-message {
  flex: 1;
  font-size: 14px;
}

.notification-close {
  background: none;
  border: none;
  color: inherit;
  font-size: 18px;
  cursor: pointer;
  margin-left: 12px;
  opacity: 0.7;
}

.notification-close:hover {
  opacity: 1;
}

.demo-controls {
  margin-top: 20px;
  padding: 20px;
  border: 1px solid #ddd;
  border-radius: 8px;
}

.button-group {
  display: flex;
  gap: 10px;
  flex-wrap: wrap;
}

.button-group button {
  padding: 10px 16px;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  transition: background-color 0.2s;
}

.button-group button:nth-child(1) { background-color: #28a745; color: white; }
.button-group button:nth-child(2) { background-color: #dc3545; color: white; }
.button-group button:nth-child(3) { background-color: #ffc107; color: black; }
.button-group button:nth-child(4) { background-color: #17a2b8; color: white; }

.button-group button:hover {
  opacity: 0.8;
}

@keyframes slideIn {
  from {
    transform: translateX(100%);
    opacity: 0;
  }
  to {
    transform: translateX(0);
    opacity: 1;
  }
}
```

---

## **Варианты заданий:**

### **Вариант 1: Компонент системы аутентификации**
Создайте компонент, который показывает разные интерфейсы для:
- Неавторизованного пользователя (форма входа)
- Обычного пользователя (приветствие)
- Администратора (панель управления)

### **Вариант 2: Компонент загрузки контента**
Создайте компонент с состояниями:
- Загрузка (спиннер)
- Успешная загрузка (контент)
- Ошибка (сообщение об ошибке)
- Пустые данные (заглушка)

### **Вариант 3: Компонент шагов формы**
Создайте многошаговую форму с:
- Индикатором прогресса
- Разными полями для каждого шага
- Кнопками "Назад/Вперед"
- Валидацией на каждом шаге

### **Вариант 4: Компонент переключения темы**
Создайте компонент для переключения между:
- Светлой темой
- Темной темой
- Автоматической темой (системной)

### **Вариант 5: Компонент фильтрации товаров**
Создайте компонент с:
- Фильтрами по категориям
- Переключением вида (сетка/список)
- Сортировкой (по цене, названию)
- Отображением количества товаров

### **Вариант 6: Компонент профиля пользователя**
Создайте компонент с разными состояниями:
- Редактирование профиля
- Просмотр профиля
- Загрузка аватара
- Изменение пароля

### **Вариант 7: Компонент корзины покупок**
Создайте компонент корзины с состояниями:
- Пустая корзина
- Товары в корзине
- Оформление заказа
- Подтверждение заказа

### **Вариант 8: Компонент комментариев**
Создайте систему комментариев с:
- Списком комментариев
- Формой добавления
- Режимом редактирования
- Ответами на комментарии

### **Вариант 9: Компонент поиска с результатами**
Создайте компонент поиска с:
- Поле ввода поиска
- Состоянием "поиск не начат"
- Состоянием "идет поиск"
- Результатами поиска
- Сообщением "ничего не найдено"

### **Вариант 10: Компонент рейтинга и отзывов**
Создайте компонент с:
- Отображением рейтинга звездами
- Формой добавления отзыва
- Списком отзывов
- Фильтрацией отзывов по оценке

### **Вариант 11: Компонент уведомлений системы**
Создайте систему уведомлений с:
- Разными типами уведомлений
- Приоритетами отображения
- Историей уведомлений
- Настройками оповещений

### **Вариант 12: Компонент дашборда с виджетами**
Создайте дашборд с:
- Переключаемыми виджетами
- Разными макетами отображения
- Настройкой видимости виджетов
- Режимом редактирования

### **Вариант 13: Компонент чата**
Создайте компонент чата с:
- Списком контактов
- Окном переписки
- Разными статусами пользователей
- Уведомлениями о новых сообщениях

### **Вариант 14: Компонент календаря событий**
Создайте календарь с:
- Разными видами (день, неделя, месяц)
- Отображением событий
- Формой создания события
- Фильтрацией событий

### **Вариант 15: Компонент настройки приложения**
Создайте компонент настроек с:
- Разделами настроек
- Переключением между разделами
- Предпросмотром изменений
- Сбросом настроек

---

## **Критерии оценки:**

### **5 (Отлично):**
- Полная реализация всех условий варианта
- Корректное применение всех видов условного рендеринга
- Чистый, хорошо структурированный код
- Полное использование нового синтаксиса (`@if`, `@switch`)
- Качественная стилизация всех состояний
- Плавные переходы между состояниями
- Полное описание в README.md

### **4 (Хорошо):**
- Основная функциональность реализована
- Правильное применение условного рендеринга
- Код в основном чистый и понятный
- Использование нового синтаксиса
- Стилизация присутствует для основных состояний
- README.md содержит основную информацию

### **3 (Удовлетворительно):**
- Базовая функциональность работает
- Применен условный рендеринг, но с ошибками
- Код требует улучшения структуры
- Минимальная стилизация
- README.md оформлен неполностью

### **2 (Неудовлетворительно):**
- Функциональность не работает
- Неправильное применение условного рендеринга
- Код не соответствует требованиям
- Отсутствует стилизация
- README.md отсутствует

---

## **Контрольные вопросы:**

1. В чем преимущества нового синтаксиса `@if` перед `*ngIf`?
2. Как создать цепочку условий с помощью `@else if`?
3. Когда следует использовать `@switch` вместо цепочки `@if`?
4. Как оптимизировать производительность при условном рендеринге?
5. Что такое "скачок содержимого" (content jump) и как его избежать?
6. Как обрабатывать асинхронные данные в условном рендеринге?
7. В чем разница между `*ngIf` и скрытием через `[hidden]`?
8. Как тестировать компоненты с условным рендерингом?
9. Какие лучшие практики применения условного рендеринга?
10. Как организовать сложные условия в шаблоне?

---

## **Пример реализации для Варианта 1 (Система аутентификации):**

**auth-system.component.ts:**
```typescript
import { Component, signal } from '@angular/core';

type UserRole = 'guest' | 'user' | 'admin';

@Component({
  selector: 'app-auth-system',
  templateUrl: './auth-system.component.html',
  styleUrls: ['./auth-system.component.css']
})
export class AuthSystemComponent {
  // Состояние аутентификации
  isLoggedIn = signal(false);
  userRole = signal<UserRole>('guest');
  userName = signal('');
  isLoading = signal(false);

  // Методы для изменения состояния
  loginAsUser() {
    this.isLoading.set(true);
    
    // Имитация асинхронного запроса
    setTimeout(() => {
      this.isLoggedIn.set(true);
      this.userRole.set('user');
      this.userName.set('Иван Петров');
      this.isLoading.set(false);
    }, 1000);
  }

  loginAsAdmin() {
    this.isLoading.set(true);
    
    setTimeout(() => {
      this.isLoggedIn.set(true);
      this.userRole.set('admin');
      this.userName.set('Администратор');
      this.isLoading.set(false);
    }, 1000);
  }

  logout() {
    this.isLoggedIn.set(false);
    this.userRole.set('guest');
    this.userName.set('');
  }
}
```

**auth-system.component.html:**
```html
<div class="auth-system">
  <h2>Система аутентификации</h2>

  <!-- Состояние загрузки -->
  @if (isLoading()) {
    <div class="loading-state">
      <div class="spinner"></div>
      <p>Выполняется вход...</p>
    </div>
  }

  <!-- Основной контент -->
  @if (!isLoading()) {
    <!-- Неавторизованный пользователь -->
    @if (!isLoggedIn()) {
      <div class="guest-view">
        <h3>Добро пожаловать!</h3>
        <p>Пожалуйста, войдите в систему</p>
        
        <div class="login-options">
          <button (click)="loginAsUser()" class="btn-user">
            Войти как пользователь
          </button>
          <button (click)="loginAsAdmin()" class="btn-admin">
            Войти как администратор
          </button>
        </div>
      </div>
    }

    <!-- Авторизованный пользователь -->
    @if (isLoggedIn()) {
      <div class="user-view">
        <!-- Общее приветствие для всех авторизованных -->
        <div class="welcome-message">
          <h3>Добро пожаловать, {{ userName() }}!</h3>
          <button (click)="logout()" class="btn-logout">
            Выйти
          </button>
        </div>

        <!-- Контент в зависимости от роли -->
        @switch (userRole()) {
          @case ('user') {
            <div class="user-content">
              <h4>Панель пользователя</h4>
              <div class="user-features">
                <div class="feature-card">
                  <h5>Мой профиль</h5>
                  <p>Управление личными данными</p>
                </div>
                <div class="feature-card">
                  <h5>Мои заказы</h5>
                  <p>История и текущие заказы</p>
                </div>
                <div class="feature-card">
                  <h5>Избранное</h5>
                  <p>Сохраненные товары</p>
                </div>
              </div>
            </div>
          }
          
          @case ('admin') {
            <div class="admin-content">
              <h4>Панель администратора</h4>
              <div class="admin-features">
                <div class="feature-card admin">
                  <h5>Управление пользователями</h5>
                  <p>Просмотр и редактирование пользователей</p>
                </div>
                <div class="feature-card admin">
                  <h5>Статистика</h5>
                  <p>Аналитика и отчеты</p>
                </div>
                <div class="feature-card admin">
                  <h5>Настройки системы</h5>
                  <p>Конфигурация приложения</p>
                </div>
                <div class="feature-card admin">
                  <h5>Модерация</h5>
                  <p>Управление контентом</p>
                </div>
              </div>
            </div>
          }
          
          @default {
            <div class="error-state">
              <p>Неизвестная роль пользователя</p>
            </div>
          }
        }
      </div>
    }
  }
</div>
```

**auth-system.component.css:**
```css
.auth-system {
  max-width: 800px;
  margin: 0 auto;
  padding: 20px;
  font-family: Arial, sans-serif;
}

.loading-state {
  text-align: center;
  padding: 40px;
}

.spinner {
  border: 4px solid #f3f3f3;
  border-top: 4px solid #007bff;
  border-radius: 50%;
  width: 40px;
  height: 40px;
  animation: spin 1s linear infinite;
  margin: 0 auto 20px;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

.guest-view {
  text-align: center;
  padding: 40px;
  background: #f8f9fa;
  border-radius: 8px;
}

.login-options {
  display: flex;
  gap: 15px;
  justify-content: center;
  margin-top: 20px;
}

button {
  padding: 12px 24px;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  font-size: 16px;
  transition: all 0.3s ease;
}

.btn-user {
  background-color: #007bff;
  color: white;
}

.btn-admin {
  background-color: #28a745;
  color: white;
}

.btn-logout {
  background-color: #dc3545;
  color: white;
  padding: 8px 16px;
  font-size: 14px;
}

button:hover {
  opacity: 0.8;
  transform: translateY(-2px);
}

.user-view {
  background: white;
  border-radius: 8px;
  padding: 20px;
  box-shadow: 0 2px 10px rgba(0,0,0,0.1);
}

.welcome-message {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 30px;
  padding-bottom: 20px;
  border-bottom: 1px solid #eee;
}

.user-features, .admin-features {
  display: grid;
  gap: 20px;
  margin-top: 20px;
}

.user-features {
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
}

.admin-features {
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
}

.feature-card {
  padding: 20px;
  border: 1px solid #e9ecef;
  border-radius: 8px;
  background: #f8f9fa;
  transition: all 0.3s ease;
}

.feature-card.admin {
  background: #fff3cd;
  border-color: #ffeaa7;
}

.feature-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 5px 15px rgba(0,0,0,0.1);
}

.feature-card h5 {
  margin: 0 0 10px 0;
  color: #333;
}

.feature-card p {
  margin: 0;
  color: #666;
  font-size: 14px;
}

.error-state {
  text-align: center;
  padding: 20px;
  background: #f8d7da;
  color: #721c24;
  border-radius: 6px;
  border: 1px solid #f5c6cb;
}
```

---

## **Инструкция по выполнению:**

1. **Создание проекта:**
```bash
ng new conditional-rendering-practice
cd conditional-rendering-practice
```

2. **Настройка нового синтаксиса:**
Убедитесь, что в `tsconfig.json` включена поддержка нового синтаксиса:
```json
{
  "angularCompilerOptions": {
    "enableI18nLegacyMessageIdFormat": false,
    "strictInjectionParameters": true,
    "strictInputAccessModifiers": true,
    "strictTemplates": true
  }
}
```

3. **Создание компонента:**
```bash
ng generate component components/auth-system
```

4. **Реализация логики согласно варианту**

5. **Тестирование всех состояний**

6. **Оформление README.md**

7. **Загрузка на Gogs**

### **Пример README.md для варианта:**

```markdown
# Практическая работа №3: Условный рендеринг в Angular

## Вариант 1: Система аутентификации с условным рендерингом

### Задание:
Создать компонент системы аутентификации, который показывает разные интерфейсы для:
- Неавторизованного пользователя (форма входа)
- Обычного пользователя (приветствие)
- Администратора (панель управления)

### Реализованные состояния:
1. **Гость** - кнопки для входа
2. **Пользователь** - базовые функции
3. **Администратор** - расширенные возможности
4. **Загрузка** - индикатор процесса входа

### Использованные техники условного рендеринга:
- `@if` / `@else` для основных состояний
- `@switch` / `@case` для разных ролей
- Условные классы для стилизации
- Анимации переходов между состояниями

### Скриншоты:

![Гость](./assets/images/guest-state.png)
![Пользователь](./assets/images/user-state.png)
![Администратор](./assets/images/admin-state.png)
```
