# Лекция: Селекторы в CSS. Приоритет, псевдо-классы и псевдо-элементы

Углубленное изучение механизма CSS-селекторов: от базовых принципов до тонкостей специфичности и продвинутых псевдо-классов.

**Цель:** Понимание системы селекторов, умение вычислять специфичность и применять псевдо-классы и псевдо-элементы для решения реальных задач верстки.

---

### **План лекции**

1.  **Введение: Что такое селекторы?**
2.  **Основные виды селекторов** (краткий обзор).
3.  **Приоритет (Специфичность) селекторов:**
    *   Что такое специфичность и зачем она нужна?
    *   Система расчета (a, b, c, d).
    *   Практические примеры и разбор "конфликтных" ситуаций.
    *   Важные исключения: `!important`.
4.  **Псевдо-классы (`:`)**
    *   Определение и синтаксис.
    *   Группы псевдо-классов:
        *   **Динамические** (`:hover`, `:focus`, `:active`).
        *   **Структурные** (`:first-child`, `:last-child`, `:nth-child()`).
        *   **Состояния элементов** (`:checked`, `:disabled`).
        *   **Прочие** (`:not()`).
    *   Примеры применения.
5.  **Псевдо-элементы (`::`)**
    *   Определение и синтаксис (одно vs. два двоеточия).
    *   Основные псевдо-элементы: `::before`, `::after`, `::first-letter`, `::first-line`, `::selection`.
    *   Примеры применения.
6.  **Резюме**
7.  **Контрольные вопросы**

---

### **1. Введение: Что такое селекторы?**

**Селектор** — это шаблон, который указывает браузеру, к каким элементам HTML применить заданные стили CSS. Это основа любого стиля.

```html
<p>Это обычный абзац.</p>
<p class="highlight">А этот абзац будет выделен.</p>
```

```css
/* Селектор по тегу */
p {
  color: black;
}

/* Селектор по классу */
.highlight {
  background-color: yellow;
}
```

### **2. Основные виды селекторов (краткий обзор)**

*   **По тегу:** `div`, `p`, `h1`
*   **По классу:** `.my-class`
*   **По ID:** `#header` (используйте осторожно!)
*   **Универсальный:** `*` (выбирает все элементы)
*   **По атрибуту:** `[type="text"]`, `[href^="https"]`
*   **Комбинаторы:**
    *   **Потомки:** `div p` (все `p` внутри `div`)
    *   **Дочерние:** `ul > li` (только прямые дочерние `li`)
    *   **Соседние:** `h1 + p` (первый `p` сразу после `h1`)

### **3. Приоритет (Специфичность) селекторов**

Когда два конфликтующих правила CSS применяются к одному элементу, браузер использует **специфичность**, чтобы решить, какое из них "победит".

**Система расчета (a, b, c, d):**
Представим себе число в виде `0,0,0,0`. Каждая часть увеличивается в зависимости от типа селектора.

*   **d (1):** Встроенные стили (`style="..."`). **(1,0,0,0)**
*   **c (2):** Селекторы по ID. **(0,1,0,0)**
*   **b (3):** Селекторы по классу, атрибуту, псевдо-классу. **(0,0,1,0)**
*   **a (4):** Селекторы по тегу, псевдо-элементу. **(0,0,0,1)**

**Примеры расчета:**

```css
*               {} /* 0,0,0,0 */
li              {} /* 0,0,0,1 */
ul li           {} /* 0,0,0,2 */
.highlight      {} /* 0,0,1,0 */
li.highlight    {} /* 0,0,1,1 */
#main-header    {} /* 0,1,0,0 */
style="color: red;" /* 1,0,0,0 - ВСТРОЕННЫЙ */
```

**Практический пример "конфликта":**

```html
<nav id="main-nav">
  <ul>
    <li class="active"><a href="#">Главная</a></li>
    <li><a href="#">О нас</a></li>
  </ul>
</nav>
```

```css
/* Специфичность: 0,0,0,2 (0,0,0,1 + 0,0,0,1) */
nav ul li a {
  color: blue;
}

/* Специфичность: 0,0,1,1 (0,0,1,0 + 0,0,0,1) */
li.active a {
  color: green;
}

/* Специфичность: 0,1,0,2 (0,1,0,0 + 0,0,0,1 + 0,0,0,1) */
#main-nav ul li a {
  color: red;
}
```
**Результат:** Ссылка "Главная" будет **красной**, так как селектор `#main-nav ul li a` имеет наибольшую специфичность.

**`!important` — атомная бомба в мире CSS**
Объявление `!important` перевешивает ВСЕ остальные правила специфичности (кроме других `!important`).

```css
.my-button {
  color: blue !important; /* Это правило победит */
}
#some-id .my-button {
  color: red; /* ...даже несмотря на высокую специфичность этого селектора */
}
```
**Совет:** Избегайте `!important`. Используйте его только как последнее средство. Он ломает естественный каскад и усложняет поддержку кода.

### **4. Псевдо-классы (`:`)**

Псевдо-классы определяют **особое состояние** элемента.

*   **Динамические:**
    ```css
    /* При наведении курсора */
    a:hover {
      text-decoration: underline;
    }

    /* Когда элемент в фокусе (например, поле ввода) */
    input:focus {
      border-color: blue;
      outline: none;
      box-shadow: 0 0 5px blue;
    }

    /* В момент нажатия (активации) */
    button:active {
      transform: scale(0.98);
    }
    ```

*   **Структурные (одни из самых полезных):**
    ```css
    /* Первый элемент в контейнере */
    ul li:first-child {
      font-weight: bold;
    }

    /* Последний элемент в контейнере */
    ul li:last-child {
      border-bottom: none;
    }

    /* Каждый 3-й элемент, начиная со 2-го (2, 5, 8...) */
    tr:nth-child(3n+2) {
      background-color: #f9f9f9;
    }

    /* Все четные элементы */
    tr:nth-child(even) {
      background-color: #f2f2f2;
    }

    /* Все нечетные элементы */
    tr:nth-child(odd) {
      background-color: #fff;
    }
    ```

*   **Состояния элементов формы:**
    ```css
    /* Отмеченный чекбокс или радио-кнопка */
    input[type="checkbox"]:checked {
      accent-color: green;
    }

    /* Выбранный вариант в <select> */
    option:checked {
      background-color: lightblue;
    }

    /* Отключенное поле */
    input:disabled {
      background-color: #eee;
      cursor: not-allowed;
    }
    ```

*   **Отрицательный псевдо-класс (`:not()`):**
    ```css
    /* Все кнопки, кроме той, у которой класс .cancel */
    button:not(.cancel) {
      background-color: #4CAF50;
    }

    /* Все элементы input, кроме тех, у которых type="checkbox" */
    input:not([type="checkbox"]) {
      width: 200px;
    }
    ```

### **5. Псевдо-элементы (`::`)**

Псевдо-элементы позволяют стилизовать определенные **части** элемента или создать содержимое, которого нет в HTML.

*   **`::before` и `::after`** (требуют свойства `content`):
    ```css
    blockquote::before {
      content: "“";
      font-size: 2em;
      color: gray;
    }
    blockquote::after {
      content: "”";
      font-size: 2em;
      color: gray;
    }

    /* Добавление иконки перед ссылкой на внешний ресурс */
    a[href^="http"]::after {
      content: " ↗";
      font-size: 0.8em;
    }
    ```

*   **`::first-letter` и `::first-line`:**
    ```css
    /* Буквица */
    p::first-letter {
      font-size: 3em;
      float: left;
      line-height: 1;
      margin-right: 5px;
    }

    /* Стилизация первой строки абзаца (адаптивно!) */
    p::first-line {
      font-variant: small-caps;
      font-weight: bold;
    }
    ```

*   **`::selection`** (стилизация выделенного текста):
    ```css
    ::selection {
      background-color: #ff6b6b;
      color: white;
    }
    ```

---

### **6. Резюме**

1.  **Селекторы** — это указатели на элементы DOM для применения стилей.
2.  **Специфичность** — это вес селектора, который определяет, какое CSS-правило будет применено. Запоминается как (inline, ID, Class, Tag). **Избегайте чрезмерного использования ID и `!important`**.
3.  **Псевдо-классы** (`:`) стилизуют элементы в определенном **состоянии** (`:hover`, `:checked`, `:nth-child()`).
4.  **Псевдо-элементы** (`::`) позволяют стилизовать определенные **части** элемента или генерировать содержимое (`::before`, `::after`, `::first-letter`).
5.  Понимание этих концепций — ключ к написанию чистого, предсказуемого и эффективного CSS-кода.

---

### **Контрольные вопросы**

1.  К какому элементу применится стиль и почему?
    ```html
    <div class="card">
      <p id="intro">Текст</p>
    </div>
    ```
    ```css
    div p { color: blue; }   /* Правило A */
    #intro { color: red; }   /* Правило B */
    .card p { color: green; } /* Правило C */
    ```

2.  Рассчитайте специфичность для селекторов:
    *   `header nav ul li a`
    *   `#sidebar .widget h2`
    *   `input[type="submit"]:hover`

3.  С помощью какого псевдо-класса можно выбрать все четные строки в таблице? Напишите пример селектора.

4.  Какой псевдо-элемент необходим, чтобы добавить декоративный элемент после заголовка? Покажите на примере кода.

5.  В чем основное различие между псевдо-классом `:focus` и псевдо-классом `:active`?

6.  Ваш коллега написал стиль `color: red !important;`, но он не применяется. Каковы возможные причины?

7.  С помощью селектора `:not()` напишите правило, которое применит серый цвет ко всем кнопкам, кроме кнопки с классом `.primary`.