# Практическая работа: Применение паттерна Repository в .NET

## Тема
Паттерн Repository в архитектуре приложений .NET

## Цель
Освоить принципы реализации и применения паттерна Repository для абстракции доступа к данным в приложениях .NET

## Теоретическая часть

### Что такое паттерн Repository?
Repository - это паттерн проектирования, который выступает промежуточным слоем между бизнес-логикой приложения и источником данных. Он инкапсулирует логику доступа к данным, предоставляя абстрактный интерфейс для работы с сущностями.

### Преимущества:
- Отделение бизнес-логики от логики доступа к данным
- Упрощение тестирования (возможность подмены реального репозитория mock-объектом)
- Единая точка управления для правил доступа к данным
- Гибкость в смене источника данных

### Базовая структура:
```
Domain Layer
    ├── Entities
    └── Repositories (Interfaces)
    
Infrastructure Layer
    └── Repositories (Implementations)
```

## Ход работы

### Практический пример: Система управления книгами

#### 1. Создаем структуру проекта

```csharp
// Domain/Entities/Book.cs
public class Book
{
    public int Id { get; set; }
    public string Title { get; set; }
    public string Author { get; set; }
    public int Year { get; set; }
    public string ISBN { get; set; }
}
```

#### 2. Определяем интерфейс репозитория

```csharp
// Domain/Interfaces/IBookRepository.cs
public interface IBookRepository
{
    Book GetById(int id);
    IEnumerable<Book> GetAll();
    void Add(Book book);
    void Update(Book book);
    void Delete(int id);
    IEnumerable<Book> FindByAuthor(string author);
    IEnumerable<Book> FindByYear(int year);
}
```

#### 3. Реализуем репозиторий

```csharp
// Infrastructure/Repositories/BookRepository.cs
public class BookRepository : IBookRepository
{
    private readonly List<Book> _books;
    private int _nextId = 1;

    public BookRepository()
    {
        _books = new List<Book>();
    }

    public Book GetById(int id)
    {
        return _books.FirstOrDefault(b => b.Id == id);
    }

    public IEnumerable<Book> GetAll()
    {
        return _books;
    }

    public void Add(Book book)
    {
        book.Id = _nextId++;
        _books.Add(book);
    }

    public void Update(Book book)
    {
        var existingBook = GetById(book.Id);
        if (existingBook != null)
        {
            existingBook.Title = book.Title;
            existingBook.Author = book.Author;
            existingBook.Year = book.Year;
            existingBook.ISBN = book.ISBN;
        }
    }

    public void Delete(int id)
    {
        var book = GetById(id);
        if (book != null)
        {
            _books.Remove(book);
        }
    }

    public IEnumerable<Book> FindByAuthor(string author)
    {
        return _books.Where(b => b.Author.Contains(author, StringComparison.OrdinalIgnoreCase));
    }

    public IEnumerable<Book> FindByYear(int year)
    {
        return _books.Where(b => b.Year == year);
    }
}
```

#### 4. Используем в приложении

```csharp
// Program.cs
class Program
{
    static void Main()
    {
        IBookRepository bookRepository = new BookRepository();
        
        // Добавление книг
        bookRepository.Add(new Book { Title = "Война и мир", Author = "Лев Толстой", Year = 1869, ISBN = "123456" });
        bookRepository.Add(new Book { Title = "Преступление и наказание", Author = "Федор Достоевский", Year = 1866, ISBN = "123457" });
        
        // Получение всех книг
        var allBooks = bookRepository.GetAll();
        Console.WriteLine("Все книги:");
        foreach (var book in allBooks)
        {
            Console.WriteLine($"{book.Id}: {book.Title} - {book.Author} ({book.Year})");
        }
        
        // Поиск по автору
        var tolstoysBooks = bookRepository.FindByAuthor("Толстой");
        Console.WriteLine("\nКниги Толстого:");
        foreach (var book in tolstoysBooks)
        {
            Console.WriteLine($"{book.Title} ({book.Year})");
        }
    }
}
```

## 15 вариантов заданий

### Вариант 1: Система управления студентами
Создайте систему для управления информацией о студентах. Реализуйте репозиторий для работы со студентами, включая методы поиска по факультету и курсу.

### Вариант 2: Библиотека фильмов
Разработайте систему учета фильмов. Реализуйте функционал поиска фильмов по жанру, году выпуска и режиссеру.

### Вариант 3: Учет сотрудников
Создайте систему для управления сотрудниками компании. Добавьте методы для поиска сотрудников по отделу и должности.

### Вариант 4: Каталог продуктов
Реализуйте систему учета продуктов магазина. Включите методы для поиска продуктов по категории и ценовому диапазону.

### Вариант 5: База заказов
Разработайте систему управления заказами. Реализуйте поиск заказов по статусу и дате.

### Вариант 6: Система бронирования отелей
Создайте систему бронирования номеров отеля. Добавьте методы для поиска свободных номеров по датам.

### Вариант 7: Учет автомобилей
Реализуйте систему учета автомобилей в автопарке. Включите поиск по марке, году выпуска и статусу.

### Вариант 8: База рецептов
Создайте систему хранения кулинарных рецептов. Реализуйте поиск по ингредиентам и времени приготовления.

### Вариант 9: Каталог музыкальных треков
Разработайте систему учета музыкальной коллекции. Добавьте поиск по исполнителю, жанру и альбому.

### Вариант 10: Система задач
Создайте систему управления задачами (todo list). Реализуйте поиск задач по приоритету и статусу выполнения.

### Вариант 11: База клиентов
Разработайте систему учета клиентов компании. Включите поиск по региону и категории клиента.

### Вариант 12: Каталог книг
Создайте систему учета книг в библиотеке. Реализуйте поиск по автору, жанру и доступности.

### Вариант 13: Учет проектов
Разработайте систему управления проектами. Добавьте поиск проектов по статусу и дедлайну.

### Вариант 14: База поставщиков
Создайте систему учета поставщиков. Реализуйте поиск по типу товаров и рейтингу.

### Вариант 15: Система мероприятий
Разработайте систему учета мероприятий. Включите поиск по дате проведения и типу мероприятия.

## Критерии оценки

### 5 (Отлично)
- Полностью реализован весь требуемый функционал
- Чистый, хорошо структурированный код
- Правильное применение паттерна Repository
- Наличие всех необходимых методов в репозитории
- Корректная работа программы
- Полное соблюдение требований к оформлению

### 4 (Хорошо)
- Реализован основной функционал
- Незначительные недочеты в архитектуре
- Минорные ошибки в коде
- Не все дополнительные методы реализованы

### 3 (Удовлетворительно)
- Реализована базовая функционалность
- Наличие существенных архитектурных недочетов
- Код требует значительных улучшений
- Частичное выполнение задания

### 2 (Неудовлетворительно)
- Функционал не реализован или реализован некорректно
- Грубые архитектурные ошибки
- Код не соответствует требованиям

## Контрольные вопросы

1. В чем заключается основная идея паттерна Repository?
2. Какие преимущества дает использование паттерна Repository?
3. Как паттерн Repository помогает в тестировании приложения?
4. В чем разница между Repository и паттерном Unit of Work?
5. Когда не следует использовать паттерн Repository?
6. Как можно расширить базовый репозиторий для специфических операций?
7. Какие альтернативы паттерну Repository существуют в .NET?

---

# Пример README.md для варианта 1

```markdown
# Практическая работа №X: Применение паттерна Repository

**Номер варианта:** 1  
**Тема:** Система управления студентами

## Задание
Создайте систему для управления информацией о студентами. Реализуйте репозиторий для работы со студентами, включая методы поиска по факультету и курсу.

## Реализация

### Структура проекта
```
StudentManagement/
├── Domain/
│   ├── Entities/
│   │   └── Student.cs
│   └── Interfaces/
│       └── IStudentRepository.cs
├── Infrastructure/
│   └── Repositories/
│       └── StudentRepository.cs
└── Program.cs
```

### Код реализации

#### Сущность Student
```csharp
public class Student
{
    public int Id { get; set; }
    public string FirstName { get; set; }
    public string LastName { get; set; }
    public string Faculty { get; set; }
    public int Course { get; set; }
    public DateTime EnrollmentDate { get; set; }
}
```

#### Интерфейс репозитория
```csharp
public interface IStudentRepository
{
    Student GetById(int id);
    IEnumerable<Student> GetAll();
    void Add(Student student);
    void Update(Student student);
    void Delete(int id);
    IEnumerable<Student> FindByFaculty(string faculty);
    IEnumerable<Student> FindByCourse(int course);
}
```

#### Реализация репозитория
```csharp
public class StudentRepository : IStudentRepository
{
    private readonly List<Student> _students;
    private int _nextId = 1;

    public StudentRepository()
    {
        _students = new List<Student>();
    }

    public Student GetById(int id)
    {
        return _students.FirstOrDefault(s => s.Id == id);
    }

    public IEnumerable<Student> GetAll()
    {
        return _students;
    }

    public void Add(Student student)
    {
        student.Id = _nextId++;
        _students.Add(student);
    }

    public void Update(Student student)
    {
        var existingStudent = GetById(student.Id);
        if (existingStudent != null)
        {
            existingStudent.FirstName = student.FirstName;
            existingStudent.LastName = student.LastName;
            existingStudent.Faculty = student.Faculty;
            existingStudent.Course = student.Course;
        }
    }

    public void Delete(int id)
    {
        var student = GetById(id);
        if (student != null)
        {
            _students.Remove(student);
        }
    }

    public IEnumerable<Student> FindByFaculty(string faculty)
    {
        return _students.Where(s => 
            s.Faculty.Contains(faculty, StringComparison.OrdinalIgnoreCase));
    }

    public IEnumerable<Student> FindByCourse(int course)
    {
        return _students.Where(s => s.Course == course);
    }
}
```

### Пример использования
```csharp
class Program
{
    static void Main()
    {
        IStudentRepository studentRepository = new StudentRepository();
        
        // Добавление студентов
        studentRepository.Add(new Student { 
            FirstName = "Иван", 
            LastName = "Петров", 
            Faculty = "Информатика", 
            Course = 2 
        });
        
        studentRepository.Add(new Student { 
            FirstName = "Мария", 
            LastName = "Сидорова", 
            Faculty = "Математика", 
            Course = 1 
        });
        
        // Поиск студентов по факультету
        var compSciStudents = studentRepository.FindByFaculty("Информатика");
        Console.WriteLine("Студенты факультета Информатика:");
        foreach (var student in compSciStudents)
        {
            Console.WriteLine($"{student.FirstName} {student.LastName}");
        }
    }
}
```

## Скриншоты работы программы

![Результат работы программы](images/program-output.png)

## Инструкция по запуску
1. Клонируйте репозиторий
2. Откройте решение в Visual Studio
3. Запустите проект
4. Проверьте работу всех методов репозитория
```

## Рекомендации по реализации

1. Создайте новый репозиторий в Gogs
2. Клонируйте репозиторий локально
3. Создайте проект по указанной структуре
4. Реализуйте выбранный вариант задания
5. Сделайте скриншоты работы программы
6. Заполните README.md согласно шаблону
7. Закоммитьте и запушьте изменения
