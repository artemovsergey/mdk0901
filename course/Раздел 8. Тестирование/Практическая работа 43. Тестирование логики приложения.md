# Практическая работа. Тестирование логики приложения с помощью xUnit

## Тема
Тестирование логики приложения с помощью xUnit в .NET

## Цель
Освоить принципы модульного тестирования, научиться создавать unit-тесты с использованием фреймворка xUnit, изучить основные атрибуты и методы тестирования.

## Теоретическая часть

### Что такое модульное тестирование?
Модульное тестирование (unit testing) - это процесс проверки отдельных компонентов программного обеспечения на корректность работы. Каждый unit-тест проверяет конкретный метод или функцию.

### Преимущества модульного тестирования:
- Раннее обнаружение ошибок
- Упрощение рефакторинга
- Документирование кода
- Уверенность в работоспособности компонентов

### xUnit.net - популярный фреймворк для тестирования в .NET

**Основные атрибуты:**
- `[Fact]` - тест без параметров
- `[Theory]` - параметризованный тест
- `[InlineData]` - данные для параметризованного теста
- `[MemberData]` - данные из свойства или метода

**Основные утверждения (Assert):**
- `Assert.Equal(expected, actual)` - проверка равенства
- `Assert.True(condition)` - проверка истинности
- `Assert.False(condition)` - проверка ложности
- `Assert.Throws<Exception>()` - проверка исключения

## Ход работы

1. Создать новый solution с проектом класса и тестовым проектом
2. Реализовать бизнес-логику согласно варианту задания
3. Написать unit-тесты, покрывающие все сценарии работы
4. Проверить покрытие кода тестами
5. Зафиксировать результаты в Git

## Практический пример

### Проект с бизнес-логикой

```csharp
// Calculator.cs
namespace BusinessLogic
{
    public class Calculator
    {
        public int Add(int a, int b) => a + b;
        
        public int Subtract(int a, int b) => a - b;
        
        public int Multiply(int a, int b) => a * b;
        
        public double Divide(int a, int b)
        {
            if (b == 0)
                throw new DivideByZeroException("Division by zero is not allowed");
            return (double)a / b;
        }
        
        public bool IsEven(int number) => number % 2 == 0;
    }
}
```

### Тестовый проект

```csharp
// CalculatorTests.cs
using BusinessLogic;

namespace BusinessLogic.Tests
{
    public class CalculatorTests
    {
        private readonly Calculator _calculator;

        public CalculatorTests()
        {
            _calculator = new Calculator();
        }

        [Fact]
        public void Add_TwoNumbers_ReturnsSum()
        {
            // Arrange
            int a = 5, b = 3;
            
            // Act
            var result = _calculator.Add(a, b);
            
            // Assert
            Assert.Equal(8, result);
        }

        [Theory]
        [InlineData(5, 3, 2)]
        [InlineData(10, 2, 8)]
        [InlineData(0, 5, -5)]
        public void Subtract_TwoNumbers_ReturnsDifference(int a, int b, int expected)
        {
            // Act
            var result = _calculator.Subtract(a, b);
            
            // Assert
            Assert.Equal(expected, result);
        }

        [Fact]
        public void Divide_ByZero_ThrowsDivideByZeroException()
        {
            // Arrange
            int a = 10, b = 0;
            
            // Act & Assert
            Assert.Throws<DivideByZeroException>(() => _calculator.Divide(a, b));
        }

        [Theory]
        [InlineData(2, true)]
        [InlineData(3, false)]
        [InlineData(0, true)]
        public void IsEven_Number_ReturnsCorrectResult(int number, bool expected)
        {
            // Act
            var result = _calculator.IsEven(number);
            
            // Assert
            Assert.Equal(expected, result);
        }
    }
}
```

## 15 вариантов заданий

### Вариант 1: Калькулятор строк
Создать класс `StringCalculator` с методами:
- `Concatenate(string a, string b)` - объединение строк
- `ContainsSubstring(string str, string substring)` - проверка наличия подстроки
- `GetLength(string str)` - получение длины строки

### Вариант 2: Валидатор email
Создать класс `EmailValidator` с методами:
- `IsValidEmail(string email)` - проверка формата email
- `GetDomain(string email)` - извлечение домена
- `GetUsername(string email)` - извлечение имени пользователя

### Вариант 3: Работа с массивами
Создать класс `ArrayProcessor` с методами:
- `FindMax(int[] array)` - поиск максимального элемента
- `FindMin(int[] array)` - поиск минимального элемента
- `CalculateSum(int[] array)` - вычисление суммы элементов

### Вариант 4: Конвертер температур
Создать класс `TemperatureConverter` с методами:
- `CelsiusToFahrenheit(double celsius)` - конвертация Цельсий в Фаренгейт
- `FahrenheitToCelsius(double fahrenheit)` - конвертация Фаренгейт в Цельсий
- `CelsiusToKelvin(double celsius)` - конвертация Цельсий в Кельвин

### Вариант 5: Генератор паролей
Создать класс `PasswordGenerator` с методами:
- `GeneratePassword(int length)` - генерация пароля заданной длины
- `IsStrongPassword(string password)` - проверка надежности пароля
- `GenerateRandomString(int length)` - генерация случайной строки

### Вариант 6: Работа с датами
Создать класс `DateHelper` с методами:
- `IsLeapYear(int year)` - проверка високосного года
- `GetDaysInMonth(int year, int month)` - получение количества дней в месяце
- `AddDays(DateTime date, int days)` - добавление дней к дате

### Вариант 7: Банковский счет
Создать класс `BankAccount` с методами:
- `Deposit(decimal amount)` - пополнение счета
- `Withdraw(decimal amount)` - снятие средств
- `GetBalance()` - получение баланса

### Вариант 8: Геометрический калькулятор
Создать класс `GeometryCalculator` с методами:
- `CalculateCircleArea(double radius)` - площадь круга
- `CalculateRectangleArea(double width, double height)` - площадь прямоугольника
- `CalculateTriangleArea(double base, double height)` - площадь треугольника

### Вариант 9: Конвертер валют
Создать класс `CurrencyConverter` с методами:
- `Convert(decimal amount, decimal rate)` - конвертация суммы
- `SetExchangeRate(string currency, decimal rate)` - установка курса
- `GetSupportedCurrencies()` - получение списка валют

### Вариант 10: Система скидок
Создать класс `DiscountCalculator` с методами:
- `CalculateDiscount(decimal amount, decimal percentage)` - расчет скидки
- `ApplyDiscount(decimal amount, decimal percentage)` - применение скидки
- `IsEligibleForDiscount(int age)` - проверка eligibility

### Вариант 11: Валидатор пароля
Создать класс `PasswordValidator` с методами:
- `ValidateLength(string password, int minLength)` - проверка длины
- `ValidateComplexity(string password)` - проверка сложности
- `HasSpecialCharacters(string password)` - проверка специальных символов

### Вариант 12: Калькулятор НДС
Создать класс `VatCalculator` с методами:
- `CalculateVatAmount(decimal amount, decimal vatRate)` - расчет суммы НДС
- `CalculateTotalWithVat(decimal amount, decimal vatRate)` - расчет итога с НДС
- `CalculateAmountWithoutVat(decimal total, decimal vatRate)` - расчет суммы без НДС

### Вариант 13: Обработчик текста
Создать класс `TextProcessor` с методами:
- `ReverseString(string text)` - реверс строки
- `CountWords(string text)` - подсчет слов
- `RemoveSpaces(string text)` - удаление пробелов

### Вариант 14: Система голосования
Создать класс `VotingSystem` с методами:
- `AddVote(string candidate)` - добавление голоса
- `GetVoteCount(string candidate)` - получение количества голосов
- `GetWinner()` - определение победителя

### Вариант 15: Менеджер задач
Создать класс `TaskManager` с методами:
- `AddTask(string task)` - добавление задачи
- `RemoveTask(string task)` - удаление задачи
- `GetTaskCount()` - получение количества задач

## Критерии оценки

**5 (Отлично):**
- Полностью реализована бизнес-логика согласно варианту
- Написаны comprehensive unit-тесты с покрытием >90%
- Тесты проверяют все граничные случаи и исключения
- Код хорошо структурирован и документирован
- Все тесты проходят успешно

**4 (Хорошо):**
- Реализована основная бизнес-логика
- Написаны основные unit-тесты с покрытием >70%
- Тесты проверяют основные сценарии
- Код структурирован адекватно
- Большинство тестов проходят успешно

**3 (Удовлетворительно):**
- Реализована базовая бизнес-логика
- Написаны минимальные unit-тесты с покрытием >50%
- Тесты проверяют только happy path
- Есть minor issues в коде
- Основные тесты проходят

**2 (Неудовлетворительно):**
- Бизнес-логика реализована не полностью
- Unit-тесты отсутствуют или покрытие <50%
- Тесты не проходят
- Серьезные issues в коде

## Контрольные вопросы

1. Что такое модульное тестирование и какие преимущества оно дает?
2. В чем разница между атрибутами `[Fact]` и `[Theory]` в xUnit?
3. Какие основные методы Assert вы знаете и для чего они используются?
4. Что такое Arrange-Act-Assert паттерн?
5. Как тестировать методы, которые выбрасывают исключения?
6. Что такое параметризованные тесты и когда их следует использовать?
7. Как организовать тестовые данные с помощью `[MemberData]`?
8. Что такое mock-объекты и когда они используются?
9. Как измерить покрытие кода тестами?
10. Какие best practices написания unit-тестов вы знаете?

---

# Пример README.md для варианта 1

```markdown
# Практическая работа №X: Тестирование логики приложения с помощью xUnit

**Вариант:** 1
**Студент:** Иванов И.И.
**Группа:** ПИ-21-1

## Задание
Создать класс `StringCalculator` с методами:
- `Concatenate(string a, string b)` - объединение строк
- `ContainsSubstring(string str, string substring)` - проверка наличия подстроки
- `GetLength(string str)` - получение длины строки

Написать unit-тесты, покрывающие все сценарии работы методов.

## Реализация

### Код бизнес-логики

```csharp
namespace BusinessLogic
{
    public class StringCalculator
    {
        public string Concatenate(string a, string b)
        {
            if (a == null) a = string.Empty;
            if (b == null) b = string.Empty;
            return a + b;
        }
        
        public bool ContainsSubstring(string str, string substring)
        {
            if (str == null || substring == null)
                return false;
                
            return str.Contains(substring);
        }
        
        public int GetLength(string str)
        {
            return str?.Length ?? 0;
        }
    }
}
```

### Код тестов

```csharp
using BusinessLogic;

namespace BusinessLogic.Tests
{
    public class StringCalculatorTests
    {
        private readonly StringCalculator _calculator;

        public StringCalculatorTests()
        {
            _calculator = new StringCalculator();
        }

        [Theory]
        [InlineData("Hello", "World", "HelloWorld")]
        [InlineData("", "Test", "Test")]
        [InlineData(null, "Value", "Value")]
        public void Concatenate_TwoStrings_ReturnsConcatenatedString(string a, string b, string expected)
        {
            // Act
            var result = _calculator.Concatenate(a, b);
            
            // Assert
            Assert.Equal(expected, result);
        }

        [Theory]
        [InlineData("Hello World", "World", true)]
        [InlineData("Hello World", "Test", false)]
        [InlineData(null, "Test", false)]
        public void ContainsSubstring_StringAndSubstring_ReturnsCorrectResult(string str, string substring, bool expected)
        {
            // Act
            var result = _calculator.ContainsSubstring(str, substring);
            
            // Assert
            Assert.Equal(expected, result);
        }

        [Theory]
        [InlineData("Hello", 5)]
        [InlineData("", 0)]
        [InlineData(null, 0)]
        public void GetLength_String_ReturnsCorrectLength(string str, int expected)
        {
            // Act
            var result = _calculator.GetLength(str);
            
            // Assert
            Assert.Equal(expected, result);
        }
    }
}
```

## Результаты тестирования

![Результаты тестирования](images/test-results.png)

## Запуск тестов

```bash
dotnet test
```

## Покрытие кода

![Покрытие кода](images/code-coverage.png)
```

## Структура репозитория

```
PracticalWork-XUnitTesting/
├── src/
│   ├── BusinessLogic/
│   │   ├── BusinessLogic.csproj
│   │   └── [Классы бизнес-логики по варианту]
│   └── BusinessLogic.Tests/
│       ├── BusinessLogic.Tests.csproj
│       └── [Тестовые классы]
├── images/
│   ├── test-results.png
│   └── code-coverage.png
├── .gitignore
└── README.md
```

## Развертывание на Gogs

1. Создать новый репозиторий в Gogs
2. Инициализировать локальный репозиторий:
```bash
git init
git add .
git commit -m "Initial commit"
```
3. Добавить remote и запушить:
```bash
git remote add origin http://gogs-server/username/repository-name.git
git push -u origin master
```